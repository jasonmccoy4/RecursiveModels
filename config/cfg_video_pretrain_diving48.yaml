# Diving48 Video Classification Training Config
# Uses V-JEPA 2 as frozen feature extractor with recursive classifier

defaults:
  - arch: trm_vjepa_diving48
  - _self_

hydra:
  output_subdir: null

# Dataset selection
dataset: diving48

# Data paths - Update these to your local Diving48 dataset location
data_root: "C:\\Users\\Jason\\ai_data\\diving48\\videos\\rgb"
train_annotations: "C:\\Users\\Jason\\ai_data\\diving48\\Diving48_train.json"
val_annotations: "C:\\Users\\Jason\\ai_data\\diving48\\Diving48_test.json"
labels_path: "C:\\Users\\Jason\\ai_data\\diving48\\Diving48_vocab.json"

# V-JEPA 2 config
vjepa_model_name: "facebook/vjepa2-vitl-fpc64-256"

# Video config
num_frames: 64  # V-JEPA 2 expects 64 frames
frame_size: 256  # V-JEPA 2 crop size

# Training hyperparams
global_batch_size: 4  # Smaller than ARC due to video memory requirements
epochs: 48
eval_interval: 3  # Evaluate every 5 epochs
checkpoint_every_eval: True

# Learning rate schedule
lr: 2.5e-6
lr_min_ratio: 0.1
lr_warmup_steps: 100

# Optimizer settings
beta1: 0.95
beta2: 0.98
weight_decay: 0.1

# Mixed precision for efficiency
mixed_precision: True

# Gradient accumulation (increase effective batch size)
gradient_accumulation_steps: 16  # Effective batch size = 4 * 16 = 64

num_workers: 12

seed: 42
