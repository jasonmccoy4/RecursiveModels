# V-JEPA 2 Recursive Video Classifier Configuration for Diving48
# 3-level gated architecture: z_G acts as element-wise gate for input injection

name: recursive_reasoning.trm_vjepa_gated@VJEPARecursiveClassifier_MultiHead
loss:
  name: losses@Diving48MultiHeadACTLossHead
  label_smoothing: 0.1
  q_loss_weight: 0.5
  head_type: multi  # "multi" for 4-head, "single" for 48-way

# Head type: "multi" (default) or "single"
# multi: 4 separate heads (position, somersault, twist, body)
# single: standard 48-way classification
head_type: multi

# V-JEPA 2 config
vjepa_hidden_size: 1024  # V-JEPA 2 ViT-L output dimension

# Recursive model config (adapted from TRM)
hidden_size: 1024  # Match V-JEPA 2 dimension
num_heads: 16  # 1024 / 64 = 16 heads
expansion: 2.0

# 3-level gated recursive structure
H_cycles: 2  # Outer loops (1 no-grad + 1 with grad)
G_cycles: 2  # Middle loops for gate evolution
L_cycles: 4  # Inner loops per G step
L_layers: 2  # Transformer blocks in L-level

# ACT (Adaptive Computation Time) config
halt_max_steps: 8  # Max ACT iterations
halt_exploration_prob: 0.1  # Exploration rate for Q-learning
no_ACT_continue: True  # Use simple sigmoid halt (no Q-continue)

# Cross-attention pooling config
cross_attn_heads: 8  # Heads for query-to-VJEPA attention

# Classification config (only used for single-head mode)
num_classes: 48  # Diving48 classes

# Positional encodings
pos_encodings: rope
rope_theta: 10000.0

# Precision
forward_dtype: bfloat16
rms_norm_eps: 1.0e-5
